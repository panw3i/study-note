查询参数笔记运算

### 查询运算符

MongoDB中常见的一些运算符：

1. 大于(`$gt`)、
2. 大于等于(`$gte`)、
3. 小于(`$lt`)、
4. 小于等于(`$lte`)、
5. 不等于(`$ne`)、
6. 包含于(`$in`)、
7. 不包含于(`$nin`)

比如下面的查询
```js
// 查询person中年龄小于30的数据
db.person.find({age: { $lt: 30 }});
```

### 数组条件

```js
// 查询person对象中，属性`tags`包含'fruit', 'food', 'citrus'之一的数据
db.person.find( { tags: [ 'fruit', 'food', 'citrus' ] } );
```

### 嵌套查询

```js
// 查询子匹配子对象属性值的数据
// 数据: {id:1,name:'test',contact:{email:12@qq.com,phone:1212}}
db.person.find({'contact.email':'12@qq.com'});
```

### 并且查询

```js
// 查询person集合中年龄(age)大于30岁，并且名字(name)为"Lucy"的数据。
db.person.find({$and:[{age:{$gt:30}}, {name:'Lucy'}]});
```

### 或者查询

```js
// 在person集合中查一下，状态(status)为"A"或年龄(age)为30的数据。
db.person.find({$or: [{status:'A'}, {age:30}]});
```

## cursor游标

> 定义：find命令并不直接返回结果，而是返回一个结果集的迭代器，即游标。

```js
//想要获取数据，我们可以使用next方法来遍历游标，如下：
var myCursor = db.inventory.find( { type: "food" } );
var myDocument = myCursor.hasNext() ? myCursor.next() : null;

if (myDocument) {
    var myItem = myDocument.item;
    print(tojson(myItem));
}

//使用forEach方法也能实现游标的遍历
var myCursor =  db.inventory.find( { type: "food" } );
myCursor.forEach(printjson);
```

## 限定查询返回的记录数

`limit`方法：设定返回结果集中的最大文档数量。
```js
// 只返回3条数据
db.person.find().limit(3)
```

## 返回指定字段

```js
// 仅仅返回name属性，如果设置为{name:0}则除了name之外所有属性都返回
// 字段条件：JSON对象，格式=>{字段：值},值等于1时表示需要返回,0时表示不需要返回。
db.person.find({}, {name:1});
```

## 复合查询

**初始化测试数据**

```js
db.users.insert([{name:"Tom",age:20,sex:"m"},{name:"Lily",age:40,sex:"f"},{name:"Suby",age:18}]);
```

### 区间查询

```js
//  请查询age大于19并且小于45的记录。
db.users.find({ age : { $gt: 19, $lt: 45} });
```

### $all匹配所有

> 这个操作符跟SQL 语法的in 类似，但不同的是, in 只需满足( )内的某一个值即可, 而$all 必须满足[ ]内的所有值

**初始测试数据**

```js
db.users.insert({"name":"David",age:26,course:["js","Node","Mongodb"]},{"name":"Tom",age:26,course:["js","Node","Mongoose"]})
```

```js
// 在users文档中课程既有"js",又有"Mongodb"的文档。

```
