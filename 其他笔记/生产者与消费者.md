生产者与消费者学习代码

```java
package com.ubuntuvim.utils_src;

/**
 * 生产者与消费者 
 */
public class ProducorConsumer {
	
	public static void main(String[] args) {
		SyncStack ss = new SyncStack();
		new Thread(new Producer(ss)).start();
		new Thread(new Producer(ss)).start();
		new Thread(new Consumer(ss)).start();
		new Thread(new Consumer(ss)).start();
	}

}

//生成、消费馒头
class WoTou {
	int id; 
	public WoTou(int id) {
		this.id = id;
	}
	public String toString() {
		return "WoTou : " + this.id;
	}
}

// 模拟存放馒头的容器，先进后出
class SyncStack {
	int index = 0;
	WoTou[] woTous = new WoTou[10];
	
	public synchronized void push(WoTou w) {
		//  如果容器满了
		while (this.index == this.woTous.length) {
			try {
				this.wait();  // 如果满了，那么停止生成，得带消费者消费馒头之后在唤醒
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
		System.out.println("唤醒消费者 " + Thread.currentThread().getId());
		this.notify();  // 唤醒消费者
		this.woTous[this.index] = w;
		this.index++;
	}
	
	public synchronized WoTou pop() {
		//  如果没有馒头了，等待生产者生成之后才能消费
		while (this.index == 0) {
			try {
				this.wait();
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
		System.out.println("唤醒生产者 " + Thread.currentThread().getId());
		this.notify();  //唤醒生产者
		this.index--;
		return this.woTous[this.index];
	}
}

// 定义生产者
class Producer implements Runnable {

	SyncStack ss = null;

	public Producer(SyncStack ss) {
		this.ss = ss;
	}
	
	@Override
	public void run() {
		for (int i = 0; i < 10; i++) {
			WoTou w = new WoTou(i);
			this.ss.push(w);  //生产
			System.out.println("生产 : " + w);
			try {
				Thread.sleep((long) (Math.random() * 1000));
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
	}
}

// 定义消费者
class Consumer implements Runnable {

	SyncStack ss = null;

	public Consumer(SyncStack ss) {
		this.ss = ss;
	}
	
	@Override
	public void run() {
		for (int i = 0; i < 10; i++) {
			WoTou w = ss.pop();//  消费
			System.out.println("消费 " + w);
			try {
				Thread.sleep((long) (Math.random() * 1000));
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
	}
}
```